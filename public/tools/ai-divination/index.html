<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI æ·±åº¦å‘½ç†å†³ç­–ç³»ç»Ÿ (å­¦ç”Ÿä¼˜åŒ–ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f8fafc; color: #334155; }
        .prose h3 { margin-top: 1.5em; color: #4f46e5; font-weight: 700; border-left: 4px solid #4f46e5; padding-left: 10px; }
        .prose strong { color: #1e293b; background: #e0e7ff; padding: 0 4px; border-radius: 2px; }
        .prose ul { list-style-type: square; color: #475569; }
        .form-section { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); margin-bottom: 16px; border: 1px solid #e2e8f0; }
        .form-label { display: block; font-size: 0.875rem; font-weight: 600; color: #64748b; margin-bottom: 6px; }
        .form-select, .form-input { width: 100%; border: 1px solid #cbd5e1; border-radius: 6px; padding: 8px 12px; font-size: 0.95rem; transition: all 0.2s; }
        .form-select:focus, .form-input:focus { border-color: #6366f1; ring: 2px solid #6366f1; outline: none; box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1); }
        .hidden-el { display: none; }
        .loader { width: 20px; height: 20px; border: 2px solid #fff; border-bottom-color: transparent; border-radius: 50%; display: inline-block; animation: rotation 1s linear infinite; }
        @keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen">

    <div class="max-w-5xl mx-auto">
        <div class="bg-slate-900 rounded-2xl p-8 text-white mb-6 shadow-xl flex flex-col md:flex-row justify-between items-center gap-4">
            <div>
                <h1 class="text-3xl font-bold tracking-tight">ğŸ§­ AI å‘½ç†å†³ç­–ç³»ç»Ÿ <span class="text-indigo-400 text-sm font-normal">Student Ed.</span></h1>
                <p class="text-slate-400 text-sm mt-2">åŸºäºå…«å­—ç®—æ³•ä¸ç°ä»£è¡Œä¸ºç§‘å­¦çš„ç²¾å‡†æ ¡æ­£</p>
            </div>
            <div class="flex items-center gap-2 bg-slate-800 p-2 rounded-lg border border-slate-700">
                <span class="text-lg">ğŸ”‘</span>
                <input type="password" id="apiKey" placeholder="è¾“å…¥ DeepSeek API Key" class="bg-transparent border-none text-sm text-white placeholder-slate-500 focus:ring-0 w-48">
                <button onclick="saveKey()" class="text-xs bg-indigo-600 hover:bg-indigo-500 px-3 py-1.5 rounded transition">ä¿å­˜</button>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            
            <div class="lg:col-span-4 space-y-4">
                <div class="form-section border-t-4 border-indigo-500">
                    <h2 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">ğŸ“… å‡ºç”Ÿä¿¡æ¯ (ç¡¬æ•°æ®)</h2>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="form-label">å§“å</label>
                            <input type="text" id="name" class="form-input" placeholder="è¯·è¾“å…¥å§“å">
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="form-label">æ€§åˆ«</label>
                                <select id="gender" class="form-select">
                                    <option value="ç”·">ç”· (ä¹¾é€ )</option>
                                    <option value="å¥³">å¥³ (å¤é€ )</option>
                                </select>
                            </div>
                            <div>
                                <label class="form-label">å†æ³•</label>
                                <select id="calendarType" class="form-select">
                                    <option value="å…¬å†">å…¬å†</option>
                                    <option value="å†œå†">å†œå†</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="form-label">å‡ºç”Ÿæ—¥æœŸ</label>
                            <input type="date" id="birthDate" class="form-input">
                        </div>
                        <div>
                            <label class="form-label">å‡ºç”Ÿæ—¶é—´/æ—¶è¾°</label>
                            <select id="birthShichen" class="form-select" onchange="toggleTimeInput(this)">
                                <option value="specific">ğŸ•’ è¾“å…¥ç²¾ç¡®æ—¶é—´ (æ¨è)</option>
                                <option value="unknown">â“ æ—¶é—´ä¸è¯¦ (ä»…æ’ä¸‰æŸ±)</option>
                                <option value="å­æ—¶ (23:00-01:00)">å­æ—¶ (23-01)</option>
                                <option value="ä¸‘æ—¶ (01:00-03:00)">ä¸‘æ—¶ (01-03)</option>
                                <option value="å¯…æ—¶ (03:00-05:00)">å¯…æ—¶ (03-05)</option>
                                <option value="å¯æ—¶ (05:00-07:00)">å¯æ—¶ (05-07)</option>
                                <option value="è¾°æ—¶ (07:00-09:00)">è¾°æ—¶ (07-09)</option>
                                <option value="å·³æ—¶ (09:00-11:00)">å·³æ—¶ (09-11)</option>
                                <option value="åˆæ—¶ (11:00-13:00)">åˆæ—¶ (11-13)</option>
                                <option value="æœªæ—¶ (13:00-15:00)">æœªæ—¶ (13-15)</option>
                                <option value="ç”³æ—¶ (15:00-17:00)">ç”³æ—¶ (15-17)</option>
                                <option value="é…‰æ—¶ (17:00-19:00)">é…‰æ—¶ (17-19)</option>
                                <option value="æˆŒæ—¶ (19:00-21:00)">æˆŒæ—¶ (19-21)</option>
                                <option value="äº¥æ—¶ (21:00-23:00)">äº¥æ—¶ (21-23)</option>
                            </select>
                            <input type="time" id="birthTime" class="form-input mt-2">
                        </div>
                        <div>
                            <label class="form-label">å‡ºç”Ÿåœ° (çœŸå¤ªé˜³æ—¶)</label>
                            <input type="text" id="birthPlace" class="form-input" placeholder="ä¾‹å¦‚ï¼šå®‰å¾½çœå®‰åº†å¸‚">
                        </div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-8 space-y-4">
                <div class="form-section border-t-4 border-emerald-500">
                    <h2 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">ğŸ§¬ å‘½ç†æ ¡æ­£ä¸äº‹å®é”šç‚¹</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="form-label">1. æ‚¨çš„æ€§æ ¼é£æ ¼ (åˆ¤æ–­å¼ºå¼±)</label>
                            <select id="personality" class="form-select">
                                <option value="" disabled selected>è¯·é€‰æ‹©...</option>
                                <option value="å¼ºåŠ¿/æ¿€è¿›">ğŸ¯ æ¿€è¿›è‡ªä¿¡ï¼Œå–œæ¬¢æŒæ§ (åèº«æ—º)</option>
                                <option value="ç¨³å¥/ä¿å®ˆ">ğŸ¢ ç¨³å¥è°¨æ…ï¼Œå¯»æ±‚å®‰å…¨ (åèº«å¼±)</option>
                                <option value="éšæ€§/è‡ªç”±">ğŸ•Šï¸ éšæ€§è‡ªç”±ï¼Œå¯Œæœ‰åˆ›æ„ (é£Ÿä¼¤æ—º)</option>
                                <option value="çº ç»“/å¤šè™‘">ğŸ¤” å®¹æ˜“çº ç»“ï¼Œæ€è™‘è¾ƒé‡ (å°é‡/æ€é‡)</option>
                            </select>
                        </div>

                        <div>
                            <label class="form-label">2. å½“å‰èº«ä»½/è¡Œä¸š (äº”è¡Œç¯å¢ƒ)</label>
                            <select id="careerType" class="form-select">
                                <option value="" disabled selected>è¯·é€‰æ‹©...</option>
                                <option value="åœ¨æ ¡å­¦ç”Ÿ/ç¡•åšç§‘ç ”">ğŸ“ åœ¨æ ¡å­¦ç”Ÿ/è€ƒç ”/è€ƒå…¬ (å°æ˜Ÿ/é£Ÿä¼¤)</option> <option value="ä½“åˆ¶å†…/è¡Œæ”¿/ç®¡ç†">ğŸ›ï¸ ä½“åˆ¶å†…/è¡Œæ”¿/ç®¡ç† (å®˜å°å±æ€§)</option>
                                <option value="é”€å”®/é‡‘è/ç»å•†">ğŸ’° é”€å”®/é‡‘è/ç»å•† (è´¢æ˜Ÿå±æ€§)</option>
                                <option value="æŠ€æœ¯/ç ”å‘/è‰ºæœ¯">ğŸ’» æŠ€æœ¯/ç ”å‘/è‰ºæœ¯ (é£Ÿä¼¤å±æ€§)</option>
                                <option value="æ•™è‚²/æ–‡åŒ–/æœåŠ¡">ğŸ“š æ•™è‚²/æ–‡åŒ–/æœåŠ¡ (å°æ˜Ÿå±æ€§)</option>
                                <option value="è‡ªç”±èŒä¸š/æ— ä¸š">â˜• è‡ªç”±èŒä¸š/æš‚ä¼‘æ•´</option>
                            </select>
                        </div>
                        
                        <div class="md:col-span-2 bg-slate-50 p-4 rounded-lg border border-slate-200">
                            <label class="form-label text-indigo-700">3. ã€æ—¶å…‰å›æº¯ã€‘è¿‡å»å“ªä¸€å¹´å‘ç”Ÿè¿‡é‡å¤§äº‹ä»¶ï¼Ÿ</label>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                <input type="number" id="pastYear" class="form-input" placeholder="å¹´ä»½ (å¦‚2022)">
                                <select id="pastEventType" class="form-select">
                                    <option value="">å‘ç”Ÿä»€ä¹ˆäº‹ï¼Ÿ</option>
                                    <option value="é‡‘æ¦œé¢˜å/å­¦ä¸šè¿›æ­¥">ğŸ“ é‡‘æ¦œé¢˜å/è€ƒç ”ä¸Šå²¸</option> <option value="è€ƒè¯•å¤±åˆ©/å­¦ä¸šå—é˜»">ğŸ“‰ è€ƒè¯•å¤±åˆ©/æŒ‚ç§‘</option>   <option value="è´¢åŠ¡å¤§å¾— (æ¶¨è–ª/ç›ˆåˆ©)">ğŸ“ˆ è´¢åŠ¡å¤§å¾— (å‘è´¢)</option>
                                    <option value="è´¢åŠ¡å¤§å¤± (ç ´äº§/è¢«éª—)">ğŸ“‰ è´¢åŠ¡å¤§å¤± (ç ´è´¢)</option>
                                    <option value="äº‹ä¸šé«˜å‡ (å‡èŒ/ä¸Šå²¸)">ğŸš€ äº‹ä¸šé«˜å‡ (å‡èŒ)</option>
                                    <option value="äº‹ä¸šå˜åŠ¨ (ç¦»èŒ/è¢«è£)">ğŸšª äº‹ä¸šå˜åŠ¨ (å¤±ä¸š)</option>
                                    <option value="æ„Ÿæƒ…å–œäº‹ (ç»“å©š/ç”Ÿå­)">ğŸ’ æ„Ÿæƒ…å–œäº‹ (ç»“å©š)</option>
                                    <option value="æ„Ÿæƒ…ç ´è£‚ (åˆ†æ‰‹/ç¦»å©š)">ğŸ’” æ„Ÿæƒ…ç ´è£‚ (åˆ†æ‰‹)</option>
                                    <option value="èº«ä½“æ¬ å®‰ (ç”Ÿç—…/æ‰‹æœ¯)">ğŸ¥ èº«ä½“æ¬ å®‰ (ç”Ÿç—…)</option>
                                </select>
                                <input type="text" id="pastEventDetail" class="form-input" placeholder="ç»†èŠ‚(é€‰å¡«)">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-section border-t-4 border-amber-500 flex flex-col md:flex-row gap-4 items-center">
                    <div class="flex-1 w-full">
                        <label class="form-label">4. æœ¬æ¬¡æ ¸å¿ƒæƒ³é—®ä»€ä¹ˆï¼Ÿ</label>
                        <select id="focusArea" class="form-select">
                            <option value="å…¨æ–¹ä½ç»¼åˆæ’ç›˜">ğŸ”® å…¨æ–¹ä½ç»¼åˆæ’ç›˜ (é»˜è®¤)</option>
                            <option value="å­¦ä¸šè€ƒè¯•ä¸å‡å­¦">ğŸ“ å­¦ä¸šè€ƒè¯•ä¸å‡å­¦ (è€ƒç ”/ç•™å­¦)</option> <option value="æé’±ç­–ç•¥ä¸äº‹ä¸š">ğŸ’° æé’±ç­–ç•¥ä¸äº‹ä¸šé£å£</option>
                            <option value="æ­£ç¼˜æ¡ƒèŠ±ä¸å©šå§»">â¤ï¸ æ­£ç¼˜æ¡ƒèŠ±ä¸å©šå§»å…³ç³»</option>
                            <option value="å¥åº·éšæ‚£ä¸è°ƒç†">ğŸ’Š å¥åº·éšæ‚£ä¸äº”è¡Œè°ƒç†</option>
                        </select>
                    </div>
                    <button onclick="calculate()" id="submitBtn" class="w-full md:w-auto px-8 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-lg shadow-lg shadow-indigo-200 transition transform active:scale-95 flex items-center justify-center gap-2">
                        <span>ğŸš€ å¼€å§‹æ¨æ¼”</span>
                    </button>
                </div>
            </div>
        </div>

        <div id="resultArea" class="hidden mt-8 bg-white rounded-2xl shadow-xl overflow-hidden min-h-[400px]">
            <div class="bg-slate-50 border-b border-slate-100 p-4 flex justify-between items-center">
                <h2 class="font-bold text-slate-700">ğŸ“œ å‘½ç†æ¨æ¼”æŠ¥å‘Š</h2>
                <div class="space-x-2">
                    <button onclick="exportDoc()" class="text-xs bg-white border border-slate-300 px-3 py-1.5 rounded hover:bg-slate-50">ğŸ“„ å­˜ä¸º Word</button>
                    <button onclick="exportPdf()" class="text-xs bg-white border border-slate-300 px-3 py-1.5 rounded hover:bg-slate-50">ğŸ“‹ å­˜ä¸º PDF</button>
                </div>
            </div>
            
            <div id="loading" class="hidden p-12 text-center">
                <div class="loader border-indigo-500 border-b-transparent"></div>
                <p class="text-slate-600 font-medium mt-4">æ­£åœ¨è®¡ç®—æµå¹´è€ƒè¿ä¸æ–‡æ˜Œä½...</p>
                <p class="text-slate-400 text-sm">AI æ­£åœ¨ç»“åˆæ‚¨çš„ã€èº«ä»½ä¸ç»å†ã€‘æ ¡æ­£æ ¼å±€...</p>
            </div>

            <div id="output" class="prose prose-slate max-w-none p-8"></div>
        </div>
        
        <div class="text-center text-slate-400 text-xs py-8">
             æ­¤ç»“æœä»…ä¾›å¨±ä¹ä¸å†³ç­–å‚è€ƒï¼Œè¯·ç›¸ä¿¡ç§‘å­¦ï¼Œç†æ€§è§„åˆ’äººç”Ÿã€‚
        </div>
    </div>

    <script>
        window.onload = () => {
            const key = localStorage.getItem('deepseek_key');
            if (key) document.getElementById('apiKey').value = key;
        };

        function saveKey() {
            const key = document.getElementById('apiKey').value.trim();
            if (key) { localStorage.setItem('deepseek_key', key); alert('API Key å·²å®‰å…¨ä¿å­˜åˆ°æœ¬åœ°'); }
        }

        function toggleTimeInput(select) {
            const timeInput = document.getElementById('birthTime');
            if (select.value === 'specific') {
                timeInput.classList.remove('hidden-el');
            } else {
                timeInput.classList.add('hidden-el');
            }
        }

        async function calculate() {
            const apiKey = document.getElementById('apiKey').value.trim();
            if (!apiKey) return alert('è¯·å…ˆå¡«å†™ DeepSeek API Key');

            const name = document.getElementById('name').value || "å‘½ä¸»";
            const gender = document.getElementById('gender').value;
            const calendar = document.getElementById('calendarType').value;
            const bDate = document.getElementById('birthDate').value;
            const bPlace = document.getElementById('birthPlace').value;

            let bTime = document.getElementById('birthShichen').value;
            if (bTime === 'specific') bTime = document.getElementById('birthTime').value;
            if (!bDate) return alert('è¯·å¡«å†™å‡ºç”Ÿæ—¥æœŸ');

            const personality = document.getElementById('personality').value;
            const career = document.getElementById('careerType').value;
            const pastYear = document.getElementById('pastYear').value;
            const pastEvent = document.getElementById('pastEventType').value;
            const pastDetail = document.getElementById('pastEventDetail').value;
            const focus = document.getElementById('focusArea').value;

            const btn = document.getElementById('submitBtn');
            const resultArea = document.getElementById('resultArea');
            const loading = document.getElementById('loading');
            const output = document.getElementById('output');

            btn.disabled = true;
            btn.classList.add('opacity-50');
            resultArea.classList.remove('hidden');
            loading.classList.remove('hidden');
            output.innerHTML = '';
            resultArea.scrollIntoView({ behavior: 'smooth' });

            const systemPrompt = `ä½ æ˜¯ä¸€ä½ç²¾é€šä¼ ç»Ÿå…«å­—ï¼ˆã€Šä¸‰å‘½é€šä¼šã€‹ã€ã€Šæ»´å¤©é«“ã€‹ï¼‰ä¸ç°ä»£å¿ƒç†å­¦çš„é«˜çº§é¡¾é—®ã€‚
            
            ã€ç‰¹æ®ŠæŒ‡ä»¤ã€‘ï¼š
            å¦‚æœç”¨æˆ·èº«ä»½æ˜¯ã€å­¦ç”Ÿã€‘ï¼Œè¯·é‡ç‚¹å…³æ³¨ï¼š
            1. **å°æ˜Ÿï¼ˆæ­£å°/åå°ï¼‰**ï¼šä»£è¡¨å­¦ä¹ èƒ½åŠ›ã€è®°å¿†åŠ›ã€æ¯äº²å…³ç…§ã€‚
            2. **é£Ÿä¼¤ï¼ˆé£Ÿç¥/ä¼¤å®˜ï¼‰**ï¼šä»£è¡¨æ‰åå‘æŒ¥ã€åº”è¯•æŠ€å·§ã€‚
            3. **æ–‡æ˜Œè´µäºº**ï¼šæµå¹´æ˜¯å¦åˆ©äºè€ƒè¯•ã€‚
            
            ä½ çš„æ ¸å¿ƒä»»åŠ¡æ˜¯ï¼šåŸºäºç”¨æˆ·çš„å…«å­—ï¼Œåˆ©ç”¨ã€æ ¡æ­£é”šç‚¹ã€‘åæ¨æ ¼å±€ï¼Œä»è€Œæä¾›ç²¾å‡†å»ºè®®ã€‚

            è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹é€»è¾‘æ€è€ƒï¼š
            1. **æ’ç›˜é˜¶æ®µ**ï¼šè®¡ç®—çœŸå¤ªé˜³æ—¶ï¼Œæ’å‡ºå››æŸ±ã€‚
            2. **æ ¼å±€æ ¡æ­£é˜¶æ®µ**ï¼š
               - ç»“åˆç”¨æˆ·æ€§æ ¼ã€${personality}ã€‘åˆ¤æ–­èº«å¼ºèº«å¼±ã€‚
               - ç»“åˆè¿‡å»äº‹ä»¶ã€${pastYear}å¹´ ${pastEvent}ã€‘åæ¨å–œç”¨ç¥æ˜¯å¦æ­£ç¡®ã€‚
            3. **å»ºè®®è¾“å‡ºé˜¶æ®µ**ï¼š
               - é’ˆå¯¹ç”¨æˆ·çš„æ ¸å¿ƒé—®é¢˜ã€${focus}ã€‘ç»™å‡ºå…·ä½“ç­–ç•¥ã€‚å¦‚æœæ˜¯å­¦ç”Ÿï¼Œè¯·å¤šè®²å­¦ä¸šè§„åˆ’ã€è€ƒç ”æ–¹å‘ã€æ–‡æ˜Œä½å¸ƒå±€ã€‚

            è¾“å‡ºæ ¼å¼è¦æ±‚ï¼ˆMarkdownï¼‰ï¼š
            - åŒ…å«ã€SWOTåˆ†æè¡¨ã€‘ã€‚
            - è¯­æ°”å®¢è§‚ã€ç†æ€§ã€é¼“åŠ±æ€§ã€‚
            - é’ˆå¯¹å­¦ç”Ÿç”¨æˆ·ï¼Œå°‘è°ˆ"å®˜åœº/å‘è´¢"ï¼Œå¤šè°ˆ"ç§¯ç´¯/æ·±é€ "`;

            const userPrompt = `
            ã€ç¡¬æ•°æ®ã€‘
            å§“åï¼š${name}ï¼Œæ€§åˆ«ï¼š${gender}
            å†æ³•ï¼š${calendar}
            ç”Ÿæ—¥ï¼š${bDate}ï¼Œæ—¶é—´ï¼š${bTime}
            å‡ºç”Ÿåœ°ï¼š${bPlace}

            ã€èº«ä»½ä¸æ ¡æ­£ã€‘
            1. æ€§æ ¼è‡ªè¯„ï¼š${personality || "æœªæä¾›"}
            2. å½“å‰èº«ä»½/è¡Œä¸šï¼š${career || "æœªæä¾›"}
            3. äº‹å®éªŒè¯ï¼š${pastYear || "æœªçŸ¥"} å¹´ï¼Œ${pastEvent || "æœªçŸ¥"}ã€‚${pastDetail ? "ç»†èŠ‚ï¼š" + pastDetail : ""}
            
            ã€æœ¬æ¬¡å’¨è¯¢ç›®æ ‡ã€‘
            ${focus}
            `;

            try {
                const res = await fetch('https://api.deepseek.com/chat/completions', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${apiKey}` },
                    body: JSON.stringify({
                        model: "deepseek-chat",
                        messages: [{role: "system", content: systemPrompt}, {role: "user", content: userPrompt}],
                        temperature: 1.1
                    })
                });

                const data = await res.json();
                if (data.error) throw new Error(data.error.message);
                
                output.innerHTML = marked.parse(data.choices[0].message.content);

            } catch (e) {
                output.innerHTML = `<div class="bg-red-50 text-red-600 p-4 rounded-lg border border-red-200">âŒ å‡ºé”™å•¦ï¼š${e.message}<br>è¯·æ£€æŸ¥ Key æ˜¯å¦æ­£ç¡®æˆ–ä½™é¢å……è¶³ã€‚</div>`;
            } finally {
                loading.classList.add('hidden');
                btn.disabled = false;
                btn.classList.remove('opacity-50');
            }
        }

        function exportDoc() {
            const content = document.getElementById('output').innerHTML;
            const header = `<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>å‘½ç†æŠ¥å‘Š</title></head><body>`;
            const source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(header + content + "</body></html>");
            const link = document.createElement("a");
            link.href = source; link.download = 'AIå‘½ç†å†³ç­–æŠ¥å‘Š.doc'; link.click();
        }
        function exportPdf() {
            html2pdf().set({ margin:10, filename: 'AIå‘½ç†å†³ç­–æŠ¥å‘Š.pdf', html2canvas:{scale:2}, jsPDF:{unit:'mm', format:'a4'} }).from(document.getElementById('output')).save();
        }
    </script>
</body>
</html>
